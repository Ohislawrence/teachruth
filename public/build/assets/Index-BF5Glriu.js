import{d as y,j as H,k as h,s as w,c as C,w as p,e as i,f as u,a as e,o as l,t as r,l as J,v as P,F as j,i as D,n as g,b as k,g as b,p as _,h as a}from"./app-CSsEuods.js";import{_ as O}from"./AppLayout-BivyDxj8.js";import{l as W}from"./lodash-BwiGWe_m.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";const G={key:0,class:"max-w-7xl mx-auto sm:px-6 lg:px-8 mt-4"},K={class:"bg-green-50 border-l-4 border-green-400 p-4"},Q={class:"flex"},X={class:"ml-3"},Y={class:"text-sm text-green-700"},Z={key:1,class:"max-w-7xl mx-auto sm:px-6 lg:px-8 mt-4"},ee={class:"bg-red-50 border-l-4 border-red-400 p-4"},te={class:"flex"},se={class:"ml-3"},oe={class:"text-sm text-red-700"},re={class:"py-12"},le={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ne={class:"grid grid-cols-1 gap-5 sm:grid-cols-4 mb-6"},ie={class:"bg-white overflow-hidden shadow rounded-lg"},ae={class:"px-4 py-5 sm:p-6"},de={class:"mt-1 text-3xl font-semibold text-gray-900"},ce={class:"bg-white overflow-hidden shadow rounded-lg"},ue={class:"px-4 py-5 sm:p-6"},me={class:"mt-1 text-3xl font-semibold text-green-600"},fe={class:"bg-white overflow-hidden shadow rounded-lg"},xe={class:"px-4 py-5 sm:p-6"},he={class:"mt-1 text-3xl font-semibold text-yellow-600"},pe={class:"bg-white overflow-hidden shadow rounded-lg"},ge={class:"px-4 py-5 sm:p-6"},ve={class:"mt-1 text-3xl font-semibold text-blue-600"},ye={class:"bg-white shadow-sm rounded-lg p-6 mb-6"},be={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},_e={class:"bg-white shadow overflow-hidden sm:rounded-lg"},we={class:"px-4 py-5 sm:px-6 border-b border-gray-200"},ke={class:"flex justify-between items-center"},Se={class:"text-sm text-gray-500"},Ce={class:"overflow-x-auto"},je={class:"min-w-full divide-y divide-gray-200"},De={class:"bg-white divide-y divide-gray-200"},Ae={class:"px-6 py-4 whitespace-nowrap"},Me={class:"flex items-center"},Te={class:"flex-shrink-0 h-10 w-10"},Ie=["src","alt"],$e={class:"ml-4"},Ve={class:"text-sm font-medium text-gray-900"},ze={class:"text-sm text-gray-500"},Le={class:"text-xs text-gray-400"},Ne={class:"px-6 py-4 whitespace-nowrap"},Ue={class:"text-sm text-gray-900"},Be={class:"text-sm text-gray-500"},Fe={class:"text-xs text-gray-400"},Ee={class:"px-6 py-4 whitespace-nowrap"},Re={class:"text-sm text-gray-900"},He={class:"text-sm text-gray-500"},Je={key:0,class:"text-xs text-gray-400"},Pe={class:"px-6 py-4 whitespace-nowrap"},Oe={key:0,class:"text-xs text-red-600 mt-1"},We={class:"px-6 py-4 whitespace-nowrap text-sm font-medium"},qe={class:"flex items-center space-x-3"},Ge=["onClick"],Ke=["onClick"],Qe=["onClick"],Xe=["onClick"],Ye={key:0,class:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6"},Ze={class:"flex-1 flex justify-between sm:hidden"},et={class:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between"},tt={class:"text-sm text-gray-700"},st={class:"font-medium"},ot={class:"font-medium"},rt={class:"font-medium"},lt={class:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination"},nt={key:1,class:"text-center py-12"},it={key:2,class:"fixed inset-0 overflow-y-auto z-50"},at={class:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},dt={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},ct={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ut={class:"sm:flex sm:items-start"},mt={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},ft={class:"mt-2"},xt={class:"text-sm text-gray-500"},ht={class:"mt-4 p-3 bg-red-50 rounded-md"},pt={key:0,class:"mt-2 p-2 bg-red-100 border border-red-200 rounded"},gt={class:"text-xs text-red-700 font-semibold"},vt={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},yt=["disabled"],bt={key:0},_t={key:1},wt=["disabled"],kt={__name:"Index",props:{schools:Object,filters:Object},setup(n){const m=n,v=y({search:m.filters?.search||""}),x=y(!1),d=y(null),f=y(!1);H(v,W.debounce(s=>{h.get(route("admin.schools"),s,{preserveState:!0,replace:!0})},300),{deep:!0});const A=()=>{v.value={search:""}},M=w(()=>m.schools?.data?m.schools.data.filter(s=>s.school_profile?.is_verified).length:0),T=w(()=>m.schools?.data?m.schools.data.filter(s=>!s.school_profile?.is_verified).length:0),I=w(()=>m.schools?.data?m.schools.data.reduce((s,t)=>s+(t.jobs_count||0),0):0),$=s=>s?s.suspended_at?"bg-red-100 text-red-800":s.school_profile?.is_verified?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800",V=s=>s?s.suspended_at?"Suspended":s.school_profile?.is_verified?"Verified":"Pending Verification":"Unknown",S=s=>s?.jobs_count?Math.floor((s.jobs_count||0)*3.5):0,z=s=>s?.jobs_count?Math.floor((s.jobs_count||0)*.6):0,L=s=>{if(!s)return"Unknown date";try{return new Date(s).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(t){return console.error("Date formatting error:",t),"Invalid date"}},N=(s,t={})=>{try{return route().has(s)?route(s,t):(console.warn(`Route ${s} not found`),"#")}catch(o){return console.error("Route error:",o),"#"}},U=s=>{if(!s?.id){console.error("School ID is missing:",s),alert("Cannot verify: Invalid school data");return}confirm("Are you sure you want to verify this school? They will be able to post jobs.")&&h.post(route("admin.schools.verify",s.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:t=>{alert("Failed to verify school")}})},B=s=>{if(!s?.id){console.error("School ID is missing:",s),alert("Cannot unverify: Invalid school data");return}confirm("Are you sure you want to remove verification from this school? They will not be able to post new jobs.")&&h.post(route("admin.schools.unverify",s.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:t=>{alert("Failed to unverify school")}})},F=s=>{if(!s?.id){console.error("School ID is missing:",s),alert("Cannot update status: Invalid school data");return}const t=s.suspended_at?"unsuspend":"suspend",o=s.suspended_at?"admin.users.unsuspend":"admin.users.suspend";if(!route().has(o)){console.error(`Route ${o} not found`),alert("Action not available");return}confirm(`Are you sure you want to ${t} this school?`)&&h.post(route(o,s.id),{},{preserveScroll:!0,onSuccess:()=>{},onError:c=>{alert("Failed to update school status")}})},E=s=>{if(!s?.id){console.error("Cannot delete: School ID is missing",s),alert("Cannot delete: Invalid school data");return}d.value=s,x.value=!0},R=()=>{if(!d.value?.id){console.error("No school selected for deletion"),x.value=!1;return}if(!route().has("admin.schools.destroy")){console.error("Route admin.schools.destroy not found"),alert("Delete action not available"),x.value=!1;return}f.value=!0,h.delete(route("admin.schools.destroy",d.value.id),{preserveScroll:!1,onSuccess:()=>{x.value=!1,d.value=null,f.value=!1},onError:s=>{console.error("Delete error:",s),alert("Failed to delete school. Please try again."),f.value=!1},onFinish:()=>{f.value=!1}})};return(s,t)=>(l(),C(O,null,{header:p(()=>[...t[2]||(t[2]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Schools Management ",-1)])]),default:p(()=>[s.$page.props.flash.success?(l(),i("div",G,[e("div",K,[e("div",Q,[t[3]||(t[3]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),e("div",X,[e("p",Y,r(s.$page.props.flash.success),1)])])])])):u("",!0),s.$page.props.flash.error?(l(),i("div",Z,[e("div",ee,[e("div",te,[t[4]||(t[4]=e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"})])],-1)),e("div",se,[e("p",oe,r(s.$page.props.flash.error),1)])])])])):u("",!0),e("div",re,[e("div",le,[e("div",ne,[e("div",ie,[e("div",ae,[t[5]||(t[5]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Total Schools",-1)),e("dd",de,r(n.schools.total),1)])]),e("div",ce,[e("div",ue,[t[6]||(t[6]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Verified",-1)),e("dd",me,r(M.value),1)])]),e("div",fe,[e("div",xe,[t[7]||(t[7]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Pending Approval",-1)),e("dd",he,r(T.value),1)])]),e("div",pe,[e("div",ge,[t[8]||(t[8]=e("dt",{class:"text-sm font-medium text-gray-500 truncate"},"Active Jobs",-1)),e("dd",ve,r(I.value),1)])])]),e("div",ye,[e("div",be,[e("div",null,[t[9]||(t[9]=e("label",{for:"search",class:"block text-sm font-medium text-gray-700"},"Search",-1)),J(e("input",{type:"text",id:"search","onUpdate:modelValue":t[0]||(t[0]=o=>v.value.search=o),placeholder:"School name, location...",class:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"},null,512),[[P,v.value.search]])]),e("div",{class:"flex items-end space-x-2"},[e("button",{onClick:A,class:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"}," Reset ")])])]),e("div",_e,[e("div",we,[e("div",ke,[t[10]||(t[10]=e("div",null,[e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," All Schools "),e("p",{class:"mt-1 max-w-2xl text-sm text-gray-500"}," Manage and monitor all registered schools in the system. ")],-1)),e("div",null,[e("span",Se," Total: "+r(n.schools.total)+" schools ",1)])])]),e("div",Ce,[e("table",je,[t[12]||(t[12]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," School "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Contact Information "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Jobs & Applications "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Status "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",De,[(l(!0),i(j,null,D(n.schools.data,o=>(l(),i("tr",{key:o.id,class:"hover:bg-gray-50"},[e("td",Ae,[e("div",Me,[e("div",Te,[e("img",{class:"h-10 w-10 rounded-full",src:o.school_profile?.logo_url||o.profile_photo_url||"/default-school.png",alt:o.school_profile?.school_name||o.name},null,8,Ie)]),e("div",$e,[e("div",Ve,r(o.school_profile?.school_name||o.name),1),e("div",ze,r((o.school_profile?.school_type||"").toUpperCase())+" • "+r((o.school_profile?.ownership||"").toUpperCase()),1),e("div",Le,r(o.school_profile?.state||"")+", "+r(o.school_profile?.lga||""),1)])])]),e("td",Ne,[e("div",Ue,r(o.email),1),e("div",Be,r(o.school_profile?.phone||"No phone"),1),e("div",Fe," Joined "+r(L(o.created_at)),1)]),e("td",Ee,[e("div",Re,r(o.jobs_count||0)+" jobs posted ",1),e("div",He,r(S(o))+" total applications ",1),o.jobs_count>0?(l(),i("div",Je,r(z(o))+" active jobs ",1)):u("",!0)]),e("td",Pe,[e("span",{class:g(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",$(o)])},r(V(o)),3),o.suspended_at?(l(),i("div",Oe," Suspended ")):u("",!0)]),e("td",We,[e("div",qe,[k(b(_),{href:N("admin.schools.show",o.id),class:"text-blue-600 hover:text-blue-900"},{default:p(()=>[...t[11]||(t[11]=[a(" View ",-1)])]),_:1},8,["href"]),o.school_profile?.is_verified?(l(),i("button",{key:1,onClick:c=>B(o),class:"text-yellow-600 hover:text-yellow-900"}," Unverify ",8,Ke)):(l(),i("button",{key:0,onClick:c=>U(o),class:"text-green-600 hover:text-green-900"}," Verify ",8,Ge)),e("button",{onClick:c=>F(o),class:g(o.suspended_at?"text-green-600 hover:text-green-900":"text-yellow-600 hover:text-yellow-900")},r(o.suspended_at?"Unsuspend":"Suspend"),11,Qe),e("button",{onClick:c=>E(o),class:"text-red-600 hover:text-red-900"}," Delete ",8,Xe)])])]))),128))])])]),n.schools.links.length>3?(l(),i("div",Ye,[e("div",Ze,[k(b(_),{href:n.schools.prev_page_url||"#",class:g([{"opacity-50 cursor-not-allowed":!n.schools.prev_page_url},"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])},{default:p(()=>[...t[13]||(t[13]=[a(" Previous ",-1)])]),_:1},8,["href","class"]),k(b(_),{href:n.schools.next_page_url||"#",class:g([{"opacity-50 cursor-not-allowed":!n.schools.next_page_url},"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50"])},{default:p(()=>[...t[14]||(t[14]=[a(" Next ",-1)])]),_:1},8,["href","class"])]),e("div",et,[e("div",null,[e("p",tt,[t[15]||(t[15]=a(" Showing ",-1)),e("span",st,r(n.schools.from),1),t[16]||(t[16]=a(" to ",-1)),e("span",ot,r(n.schools.to),1),t[17]||(t[17]=a(" of ",-1)),e("span",rt,r(n.schools.total),1),t[18]||(t[18]=a(" schools ",-1))])]),e("div",null,[e("nav",lt,[(l(!0),i(j,null,D(n.schools.links,(o,c)=>(l(),C(b(_),{key:c,href:o.url||"#",class:g(["relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",{"bg-blue-50 border-blue-500 text-blue-600 z-10":o.active,"rounded-l-md":c===0,"rounded-r-md":c===n.schools.links.length-1,"opacity-50 cursor-not-allowed":!o.url}]),innerHTML:o.label},null,8,["href","class","innerHTML"]))),128))])])])])):u("",!0),n.schools.data.length===0?(l(),i("div",nt,[...t[19]||(t[19]=[e("svg",{class:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})],-1),e("h3",{class:"mt-2 text-sm font-medium text-gray-900"},"No schools found",-1),e("p",{class:"mt-1 text-sm text-gray-500"}," No schools match your current search criteria. ",-1)])])):u("",!0)])])]),x.value?(l(),i("div",it,[e("div",at,[t[27]||(t[27]=e("div",{class:"fixed inset-0 transition-opacity","aria-hidden":"true"},[e("div",{class:"absolute inset-0 bg-gray-500 opacity-75"})],-1)),t[28]||(t[28]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",dt,[e("div",ct,[e("div",ut,[t[25]||(t[25]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("div",mt,[t[24]||(t[24]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Delete School ",-1)),e("div",ft,[e("p",xt,[t[20]||(t[20]=a(" Are you sure you want to delete ",-1)),e("strong",null,r(d.value?.school_profile?.school_name||d.value?.name),1),t[21]||(t[21]=a("? This action cannot be undone. ",-1))]),e("div",ht,[t[22]||(t[22]=e("p",{class:"text-sm text-red-700"},[e("strong",null,"Warning:"),a(" This will permanently delete: ")],-1)),t[23]||(t[23]=e("ul",{class:"mt-1 text-sm text-red-600 list-disc list-inside"},[e("li",null,"School profile and all details"),e("li",null,"All job postings"),e("li",null,"All job applications for this school"),e("li",null,"User account")],-1)),d.value?.jobs_count>0?(l(),i("div",pt,[e("p",gt," ⚠️ This school has "+r(d.value.jobs_count)+" active job postings with "+r(S(d.value))+" applications! ",1)])):u("",!0)])])])])]),e("div",vt,[e("button",{type:"button",onClick:R,disabled:f.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[f.value?(l(),i("span",bt,[...t[26]||(t[26]=[e("svg",{class:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24"},[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),a(" Deleting... ",-1)])])):(l(),i("span",_t," Delete "))],8,yt),e("button",{type:"button",onClick:t[1]||(t[1]=o=>x.value=!1),disabled:f.value,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,wt)])])])])):u("",!0)]),_:1}))}},At=q(kt,[["__scopeId","data-v-f806ce1c"]]);export{At as default};
